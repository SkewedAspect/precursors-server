package precursors;

option java_package = "com.skewedaspect.precursors";
option java_outer_classname = "PreProtos";


import "common.proto";
import "requests.proto";
import "events.proto";


/// Request message. Requests always generate a Response.
message Request {
  required int32 id = 1;
  repeated KeyValuePair properties = 2;

  // Request types - ONLY ONE of these should be present.
  optional Ping ping = 3;
  optional Login login = 4;
  optional Logout logout = 5;
  optional CreateNewChannel newchannel = 6;

  // Allow extensions to this message
  extensions 100 to 199;
}

/// Response message. Only generated by a Request.
message Response {
  required int32 id = 1;
  required bool confirm = 2;

  // Generic message fields
  required int32 inResponseTo = 3;
  optional string messageString = 4;

  // Allow extensions to this message
  extensions 100 to 199;
}

/// Event message.
message Event {
  required int32 id = 1;
  required string eventString = 2;

  repeated KeyValuePair properties = 3;

  // Event types - ONLY ONE of these should be present.
  optional MessageEvent message = 4;

  // Allow extensions to this message
  extensions 100 to 199;
}

message Envelope {
	// exactly one
	optional Request request = 1;
	optional Response response = 2;
	optional Event event = 3;
}
